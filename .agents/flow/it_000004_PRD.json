{
  "goals": [
    "Provide the LLM with a well-defined, structured prompt (SKILL.md) that produces valid Strudel pattern strings every time.",
    "Establish `backend/llm-skills/` as the dedicated directory for LLM-consumed skill files.",
    "Enable richer, more varied lofi patterns than the current static lookup approach."
  ],
  "userStories": [
    {
      "id": "US-001",
      "title": "Create the Strudel pattern generator skill file",
      "description": "As an LLM invoked to generate a lofi pattern, I want a structured skill document that specifies valid Strudel syntax, parameter mappings, and expected output format so that I produce a valid Strudel pattern string that plays without errors in the REPL.",
      "acceptanceCriteria": [
        {
          "id": "US-001-AC01",
          "text": "File exists at `backend/llm-skills/strudel-pattern-generator/SKILL.md`"
        },
        {
          "id": "US-001-AC02",
          "text": "File follows the Anthropic Claude Code skill standard: YAML frontmatter (between `---` markers) + markdown body"
        },
        {
          "id": "US-001-AC03",
          "text": "Frontmatter includes `name: strudel-pattern-generator` and a descriptive `description` field"
        },
        {
          "id": "US-001-AC04",
          "text": "Frontmatter includes `disable-model-invocation: true` (skill is consumed programmatically, not auto-triggered)"
        },
        {
          "id": "US-001-AC05",
          "text": "Markdown body documents valid Strudel mini-notation syntax: sound names (`bd`, `sd`, `hh`, `cp`), rhythm notation (`~`, `*N`, `[]`), and chaining methods (`.stack()`, `.slow()`, `.gain()`, `.cpm()`)"
        },
        {
          "id": "US-001-AC06",
          "text": "Markdown body defines explicit parameter mappings:"
        },
        {
          "id": "US-001-AC07",
          "text": "Markdown body includes at least one complete, valid example pattern per style (`jazz`, `hip-hop`, `ambient`)"
        },
        {
          "id": "US-001-AC08",
          "text": "Markdown body specifies the exact output format the LLM must return: a single-line Strudel pattern string compatible with the REPL (no explanation, no code block, just the pattern string)"
        },
        {
          "id": "US-001-AC09",
          "text": "Typecheck / lint passes (SKILL.md is not a TypeScript file; verify YAML frontmatter is valid YAML)"
        }
      ]
    },
    {
      "id": "US-002",
      "title": "Validate skill output against the Strudel REPL",
      "description": "As the lofi-maker app, I want to confirm that a pattern string generated by an LLM following the skill guide plays in the Strudel REPL without errors so that the skill is proven effective before integration into app code.",
      "acceptanceCriteria": [
        {
          "id": "US-002-AC01",
          "text": "At least 3 manually crafted test pattern strings (one per style) following the skill's output format are documented in `backend/llm-skills/strudel-pattern-generator/examples/valid-patterns.md`"
        },
        {
          "id": "US-002-AC02",
          "text": "Each example pattern is a valid `stack([...]).slow(N).gain(N).cpm(N)` expression"
        },
        {
          "id": "US-002-AC03",
          "text": "Each example is visually verified to play in the browser REPL without throwing a console error"
        }
      ]
    }
  ],
  "functionalRequirements": [
    {
      "id": "FR-1",
      "description": "** Create directory `backend/llm-skills/strudel-pattern-generator/` with `SKILL.md` as the entrypoint."
    },
    {
      "id": "FR-2",
      "description": "** `SKILL.md` YAML frontmatter must contain at minimum: `name`, `description`, `disable-model-invocation: true`."
    },
    {
      "id": "FR-3",
      "description": "** `SKILL.md` body must document Strudel mini-notation syntax sufficient to construct `stack([s(\"...\"), s(\"...\")])` patterns with timing and gain controls."
    },
    {
      "id": "FR-4",
      "description": "** `SKILL.md` body must contain a parameter-to-pattern mapping section covering all current `Mood` and `Style` values defined in `src/lib/pattern-generator.ts`."
    },
    {
      "id": "FR-5",
      "description": "** `SKILL.md` body must specify the LLM output contract: return only a single-line valid Strudel pattern string, no prose, no markdown code fences."
    },
    {
      "id": "FR-6",
      "description": "** `SKILL.md` body must include a section with at least 3 complete, copy-pasteable example outputs (one per style)."
    },
    {
      "id": "FR-7",
      "description": "** Create `backend/llm-skills/strudel-pattern-generator/examples/valid-patterns.md` containing the example patterns from FR-6, used for manual REPL verification."
    }
  ]
}
